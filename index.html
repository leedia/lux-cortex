<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lux Cortex</title>
  <style>
    body { background: white; color: black; font-family: Georgia, serif; margin: 0; padding: 20px; line-height: 1.8; }
    .container { max-width: 700px; margin: auto; padding-bottom: 100px; }
    h1 { text-align: center; font-size: 2.5em; margin-bottom: 2em; font-weight: normal; letter-spacing: 0.1em; }
    .paragraph { 
      margin-bottom: 1.5em; 
      font-size: 1.1em; 
      transition: opacity 0.5s ease; 
      white-space: pre-wrap; 
      position: relative;
    }
    .paragraph.scattering-active {
      height: auto;
      min-height: 1.8em;
    }
    .restart-btn, .scroll-prompt, .continue-btn { position: fixed; font-family: Georgia, serif; color: #333; background: none; border: none; }
    .restart-btn { top: 20px; left: 20px; cursor: pointer; text-decoration: underline; display: none; }
    .scroll-prompt { bottom: 60px; left: 50%; transform: translateX(-50%); font-size: 0.9em; animation: fadeInOut 3s ease-in-out infinite; }
    .continue-btn { bottom: 30px; left: 50%; transform: translateX(-50%); background: white; border: 1px solid #333; padding: 10px 20px; cursor: pointer; display: none; }
    @keyframes fadeInOut { 0%,100% { opacity: 0; } 50% { opacity: 1; } }
    .redacting { position: relative; display: inline-block; transition: all 1.5s ease; }
    .redacting::after { content: ''; position: absolute; left: 0; top: 0; width: 0; height: 100%; background: black; transition: width 1.5s ease; }
    .redacting.redacted::after { width: 100%; }
    .redacting.redacted { color: transparent; }
    .redacting.clearing::after { width: 0; opacity: 0; }
    .redacting.clearing { color: black; }
    .word-fade { display: inline-block; transition: all 2s ease; }
    .word-fade.fading { opacity: 0.2; filter: blur(1px); }
    .word-fade.clearing { opacity: 1; filter: blur(0); }
    .scatter-char { display: inline-block; transition: all 4s cubic-bezier(0.4, 0, 0.2, 1); white-space: pre; }
    .scatter-char.scattering { opacity: 0; }
    .elena-word { display: inline-block; font-style: italic; }
  </style>
</head>
<body>
  <button id="restart-btn" class="restart-btn" onclick="restartReading()">Restart Memory</button>

  <div class="container" id="main-container">
    <h1>Lux Cortex</h1>
    <div id="story-content"></div>
  </div>


  <button id="continue-btn" class="continue-btn" onclick="continueReading()">Continue Reading</button>

  <script>
    // EDIT YOUR STORY HERE - Just replace the text between the backticks
    const storyText = `The dreams always scattered with the light.

Chell woke to find every bulb in his apartment burning—kitchen strips humming, overheads casting harsh shadows, even the small reading lamp glowing like a vigil. Behind his closed eyelids, fragments lingered: pulses of blue-white radiance, voices calling his name from somewhere beyond reach. Nothing coherent. Just the lingering taste of photons and inexplicable certainty that something important lived in those scattered moments of dreaming light.

He made a note: Schedule neural checkup. Possible implant drift.

By nine, he had opened Lux Cortex Designs.

Unlike the seedy parlors that littered the highways, announcing themselves with flickering neon skulls, lurid promises, and ink-smeared walls, Lux Cortex set itself apart. The interior was clean lines and ambient lighting, air scented with bergamot. The photostimulation chair dominated the space like an altar—brushed titanium embedded with fiber optic arrays that could deliver light with nanometer precision.

Optogenetic enhancement, or as popular culture put it, brain tattoos. Using genetically modified neurons and precisely calibrated light to make recollections permanently vivid, triggered anew by every ray of light. Beautiful and irreversible.

At ten, Emma and David arrived—newly married, glowing with the particular radiance of two people convinced their happiness was eternal. She wore a tailored white jumpsuit with silver earrings that caught the morning light; he wore a soft gray blazer and the tentative confidence of someone in love.

They wanted matching enhancements of their wedding day, permanent neural monuments to what they were sure would be lifelong devotion.

"The process is completely irreversible," Chell said mildly. "Unlike a physical tattoo, imprinted memories don't fade or change. What you preserve today will trigger with the same intensity twenty years from now, regardless of how your feelings evolve.

Emma squeezed David's hand and looked up at him with practiced adoration. "Our love will never change."

Chell, noting everything, said nothing. David's other hand subtly removed hers. Chell turned to the charts laid out on his desk, neural scans of now-divorced clients, when Matthew Donovan arrived unscheduled, hollow-eyed and desperate.

"Please," he said to Chell, giving no indication he noticed Emma or David there. "She won't go. I can't go on a date, can't look at another woman without seeing her face."

Three years ago, Donovan had optogenetically enhanced a memory of his dead wife. Chell had tried to warn him but grief had taken the widower's innate stubbornness and hardened it like concrete.

"Every sunrise brings her back with perfect clarity." His voice cracked. "My Sarah. I'm trapped by the most beautiful memory of my life."

Emma and David exchanged uncertain glances. The glow faded from their faces as they absorbed Donovan's raw pain. They left without scheduling a second procedure.

Donovan remained focused on Chell with tears in his eyes. "I need you to try the scrambling. Please."

Chell refused, as he always did. In theory, what Donovan asked for was possible. Imprint a scrambled pattern across the hippocampus to disrupt the tattooed memory, replace meaning with static. But the risks were too severe with such a delicate subject like memory. Other practitioners had tried only for their patients to develop emotional destabilization, insanity, identity erosion. Donovan left with the same haunted expression, and Chell sat alone in the silence pondering the Hippocratic oath.

Near closing, a woman entered the shop like smoke. Her hair was dark, almost black, and caught the ambient lighting in muted halos. Something about her presence unsettled him even before she spoke.

"I'm interested in your services," she said, settling into the consultation chair with unusual grace.

"What kind of memory enhancement?"

"Actually, I'm curious about suppression. I know that optogenetic techniques can theoretically disrupt memories rather than enhance them."

Chell felt his pulse quicken. "That's… experimental. Not something I typically offer."

"But possible?"

"Theoretically. Inhibitory opsins like halorhodopsins could weaken specific pathways so that light suppresses a memory instead of recalling it. But it's risky, and never been approved for human subjects so I'm afraid I can't help you there." He studied her face. "Why suppression rather than enhancement?"

"Have you ever had a memory so beautiful it became a prison? Love so powerful you could only heal by forgetting?"

Her phrasing unsettled him. She asked sophisticated technical questions, displaying knowledge that suggested neuroscience background. Through it all, she wore a smile that never reached her eyes—sad, knowing, achingly familiar.

"Could you at least try?" she asked finally.

He shook his head slowly. "Even if I could, I'd need extensive preparation. Experimental techniques require—"

"What if someone had already done it? To themselves?" Her voice was gentle, almost clinical. "Would there be signs? Sleep disturbances, confusion upon waking, dreams full of light and voices you can't place?"

The question hit him like a physical blow. His vision tunneled, the room suddenly too bright.

"Why are you asking me this?"

She regarded him quietly, and he had the strangest sensation she was seeing him more clearly than he saw himself. "Because I think you already know the answer."

She left without another word, and Chell stood alone surrounded by technology he'd mastered through years of study, suddenly feeling like a stranger in his own life.

That night, he sat gingerly at the edge of his bedspread and turned off the lights, one by one, until he sat in darkness for the first time in months.

Behind his closed eyelids, fragments sharpened into clarity. A woman's voice, soft and familiar. The soft brush of someone else's hand. A profound loss from somewhere deeper than conscious memory.

[ELENA]And then, rising like bubbles through still water, a single word spoken with infinite tenderness: Elena.[/ELENA]

He woke in sunlight, tears streaming down his face.

Chell wiped his eyes and made a note to check his implants. Turning on the light by his bed, he prepared for another day at Lux Cortex Designs. Some people, he reflected, simply weren't built for the intensity of perfect recollection. Better to rely on the gentle fade of natural memory than risk the kind of devastating clarity that had destroyed clients like Matthew Donovan.

How fortunate, he thought, that he'd had the wisdom never to enhance a memory of his own.`;

    // Parse the story and create paragraphs
    function initializeStory() {
      const container = document.getElementById('story-content');
      const paragraphs = storyText.trim().split('\n\n');
      
      paragraphs.forEach(para => {
        const div = document.createElement('div');
        div.className = 'paragraph';
        
        // Check if this paragraph contains the special Elena marker
        if (para.includes('[ELENA]')) {
          div.classList.add('elena-sentence');
          // Remove the markers for display
          para = para.replace('[ELENA]', '').replace('[/ELENA]', '');
        }
        
        div.textContent = para;
        div.setAttribute('data-original', para);
        container.appendChild(div);
      });
    }

    // Rest of your JavaScript remains the same
    let readCount = 1, ready = false;
    let stageExecuted = {2: false, 3: false, 4: false};
    const properNouns = ['Chell','Lux Cortex Designs','Emma','David','Matthew Donovan','Sarah','Elena','Donovan'];
    const emotionalWords = ['love','beautiful','happiness','memory','dreams','tears','familiar','loss','heart','smile','sad','profound','darkness','light','fragments','certainty','important','devotion','memories','intensity','feelings','adoration','desperate','grief','clarity','glow','pain','sensation','tenderness','intensity'];

    function restartReading() { window.location.reload(); }

    window.addEventListener('scroll', () => {
      const pos = window.scrollY;
      const bottom = document.documentElement.scrollHeight - window.innerHeight;
      if (!ready && pos >= bottom - 5) {
        if (readCount < 4) {
          document.getElementById('continue-btn').style.display = 'block';
        }
        ready = true;
      }
      if (ready && pos < 50 && !stageExecuted[readCount]) {
        document.getElementById('continue-btn').style.display = 'none';
        runStage();
        ready = false;
      }
    });

    function continueReading() {
      readCount++;
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function runStage() {
      if (readCount === 2 && !stageExecuted[2]) {
        stageExecuted[2] = true;
        redaction();
      }
      else if (readCount === 3 && !stageExecuted[3]) {
        stageExecuted[3] = true;
        fadeWords();
      }
      else if (readCount === 4 && !stageExecuted[4]) {
        stageExecuted[4] = true;
        scatterByParagraph();
      }
    }

    function redaction() {
      document.querySelectorAll('.paragraph').forEach((p, i) => {
        setTimeout(() => {
          let html = p.getAttribute('data-original');
          properNouns.forEach(n => {
            html = html.replace(new RegExp(`\\b${n}\\b`, 'g'), `<span class="redacting">${n}</span>`);
          });
          p.innerHTML = html;
          setTimeout(() => p.querySelectorAll('.redacting').forEach(el => el.classList.add('redacted')), 500);
        }, i * 300);
      });
    }

    function fadeWords() {
      document.querySelectorAll('.paragraph').forEach((p, i) => {
        setTimeout(() => {
          let html = p.innerHTML;
          emotionalWords.forEach(w => {
            html = html.replace(new RegExp(`\\b${w}\\b`, 'gi'), `<span class="word-fade">${w}</span>`);
          });
          p.innerHTML = html;
          setTimeout(() => p.querySelectorAll('.word-fade').forEach(el => el.classList.add('fading')), 500);
        }, i * 300);
      });
    }

    function scatterByParagraph() {
      clearPreviousAnimations();
      
      setTimeout(() => {
        document.querySelectorAll('.paragraph').forEach(p => {
          const obs = new IntersectionObserver((entries, o) => {
            entries.forEach(entry => {
              if (entry.isIntersecting) {
                o.disconnect();
                scatterParagraph(p);
              }
            });
          }, { threshold: 0.6 });
          obs.observe(p);
        });
      }, 2000);
    }
    
    function clearPreviousAnimations() {
      document.querySelectorAll('.redacting').forEach(el => {
        el.classList.remove('redacted');
        el.classList.add('clearing');
      });
      
      document.querySelectorAll('.word-fade').forEach(el => {
        el.classList.remove('fading');
        el.classList.add('clearing');
      });
      
      setTimeout(() => {
        document.querySelectorAll('.paragraph').forEach(p => {
          p.innerHTML = p.getAttribute('data-original');
        });
      }, 1500);
    }

    function scatterParagraph(p) {
      const text = p.textContent;
      const isElenaParagraph = p.classList.contains('elena-sentence');
      
      const rect = p.getBoundingClientRect();
      p.style.height = rect.height + 'px';
      p.style.width = rect.width + 'px';
      p.classList.add('scattering-active');
      
      p.innerHTML = '';
      
      if (isElenaParagraph) {
        const beforeElena = 'And then, rising like bubbles through still water, a single word spoken with infinite tenderness: ';
        const elenaWord = 'Elena';
        const afterElena = '.';
        
        beforeElena.split('').forEach((c, i) => {
          const span = document.createElement('span');
          span.textContent = c;
          span.className = 'scatter-char';
          p.appendChild(span);
          setTimeout(() => {
            if (c !== ' ') {
              const x = (Math.random() - 0.5) * 600;
              const y = (Math.random() - 0.5) * 400;
              span.style.transform = `translate(${x}px, ${y}px) rotate(${(Math.random() - 0.5) * 360}deg)`;
              span.classList.add('scattering');
            }
          }, i * 40);
        });
        
        const elenaSpan = document.createElement('span');
        elenaSpan.textContent = elenaWord;
        elenaSpan.className = 'elena-word';
        p.appendChild(elenaSpan);
        
        const periodSpan = document.createElement('span');
        periodSpan.textContent = afterElena;
        periodSpan.className = 'scatter-char';
        p.appendChild(periodSpan);
        setTimeout(() => {
          periodSpan.style.transform = `translate(${(Math.random() - 0.5) * 400}px, ${(Math.random() - 0.5) * 300}px)`;
          periodSpan.classList.add('scattering');
        }, (beforeElena.length + 1) * 40);
        
        setTimeout(() => {
          document.getElementById('restart-btn').style.display = 'block';
        }, beforeElena.length * 40 + 4000);
        
      } else {
        text.split('').forEach((c, i) => {
          const span = document.createElement('span');
          span.textContent = c;
          span.className = 'scatter-char';
          p.appendChild(span);
          setTimeout(() => {
            if (c !== ' ') {
              const x = (Math.random() - 0.5) * 600;
              const y = (Math.random() - 0.5) * 400;
              span.style.transform = `translate(${x}px, ${y}px) rotate(${(Math.random() - 0.5) * 360}deg)`;
              span.classList.add('scattering');
            }
          }, i * 30);
        });
      }
    }

    // Initialize the story when the page loads
    window.addEventListener('DOMContentLoaded', initializeStory);
  </script>
</body>
</html>